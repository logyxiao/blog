---
interface Props {
	path?: string;
	lang?: string;
}

const { path = Astro.url.pathname, lang = "zh-cn" } = Astro.props;
---

<div id="waline" class="waline-container"></div>

<script>
import { init } from '@waline/client';
import '@waline/client/style';

if (typeof window !== 'undefined') {
	// Waline åˆå§‹åŒ–
	init({
		el: '#waline',
		serverURL: 'https://vercel-blog-sooty-psi.vercel.app/', // ä½ éœ€è¦æ›¿æ¢ä¸ºå®é™…çš„æœåŠ¡ç«¯URL
		path: window.location.pathname,
		lang: document.documentElement.lang || 'zh-cn',
		
		// åŸºç¡€é…ç½®
		pageSize: 10,
		wordLimit: [0, 1000],
		
		// éšç§é…ç½® - ä¸æ˜¾ç¤ºç”¨æˆ·ä»£ç†ä¿¡æ¯ï¼ˆæµè§ˆå™¨ç‰ˆæœ¬å’Œç³»ç»Ÿï¼‰
		meta: ['nick', 'mail'],
		requiredMeta: ['nick', 'mail'],
		
		// è¡¨æƒ…åŒ…é…ç½®
		emoji: [
			'https://unpkg.com/@waline/emojis@1.2.0/weibo',
			'https://unpkg.com/@waline/emojis@1.2.0/alus',
			'https://unpkg.com/@waline/emojis@1.2.0/bilibili'
		],
		
		// æœç´¢é…ç½®
		search: false,
		
		// å›¾ç‰‡ä¸Šä¼ ï¼ˆå¯é€‰ï¼Œå¦‚æœä¸éœ€è¦å¯ä»¥è®¾ä¸ºfalseï¼‰
		imageUploader: false,
		
		// å›½é™…åŒ–
		locale: {
			placeholder: 'æ¬¢è¿ç•™è¨€è®¨è®º...',
			sofa: 'å¿«æ¥å‘è¡¨ç¬¬ä¸€æ¡è¯„è®ºå§ï¼',
			submit: 'æäº¤',
			like: 'å–œæ¬¢',
			cancelLike: 'å–æ¶ˆå–œæ¬¢',
			reply: 'å›å¤',
			more: 'åŠ è½½æ›´å¤š...',
			preview: 'é¢„è§ˆ',
			emoji: 'è¡¨æƒ…',
			uploadImage: 'ä¸Šä¼ å›¾ç‰‡',
			seconds: 'ç§’å‰',
			minutes: 'åˆ†é’Ÿå‰',
			hours: 'å°æ—¶å‰',
			days: 'å¤©å‰',
			now: 'åˆšåˆš',
			uploading: 'æ­£åœ¨ä¸Šä¼ ',
			login: 'ç™»å½•',
			logout: 'é€€å‡º',
			admin: 'åšä¸»',
			sticky: 'ç½®é¡¶',
			word: 'å­—',
			wordHint: 'è¯„è®ºå­—æ•°åº”åœ¨ $0 åˆ° $1 å­—ä¹‹é—´ï¼\n å½“å‰å­—æ•°ï¼š$2',
			anonymous: 'åŒ¿å',
			level0: 'æ½œæ°´',
			level1: 'å†’æ³¡',
			level2: 'åæ§½',
			level3: 'æ´»è·ƒ',
			level4: 'è¯ç—¨',
			level5: 'ä¼ è¯´',
			gif: 'GIF',
			gifSearchPlaceholder: 'æœç´¢ GIF'
		}
	});
}
</script>

<style>
/* ç°ä»£ç®€çº¦è¯„è®ºåŒºæ ·å¼ */

.waline-container {
	margin-top: 3rem;
	padding: 0;
	background: transparent;
	border: none;
}

.waline-container::before {
	content: "ğŸ’¬ è¯„è®ºäº¤æµ";
	display: block;
	font-size: 1.25rem;
	font-weight: 600;
	color: #1f2937;
	margin-bottom: 2rem;
	padding-bottom: 0.75rem;
	border-bottom: 2px solid #e5e7eb;
	letter-spacing: 0.05em;
}

:global(.wl-container) {
	--waline-font-size: 15px;
	--waline-white: #ffffff;
	--waline-light-grey: #f8fafc;
	--waline-dark-grey: #64748b;
	--waline-color: #334155;
	--waline-bg-color: #ffffff;
	--waline-bg-color-light: #f8fafc;
	--waline-bg-color-hover: #f1f5f9;
	--waline-border-color: #e2e8f0;
	--waline-disable-bg-color: #f8fafc;
	--waline-disable-color: #94a3b8;
	--waline-bq-color: #475569;
	--waline-info-bg-color: #dbeafe;
	--waline-info-color: #1e40af;
	
	font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
}

/* ç¼–è¾‘å™¨æ ·å¼ä¼˜åŒ– */
:global(.wl-editor) {
	background: #ffffff;
	border: 2px solid #e2e8f0;
	border-radius: 12px;
	padding: 1.25rem;
	box-shadow: 0 1px 3px 0 rgba(0, 0, 0, 0.1);
	transition: all 0.3s ease;
	margin-bottom: 1.5rem;
}

:global(.wl-editor:focus-within) {
	border-color: #3b82f6;
	box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.1), 0 4px 6px -1px rgba(0, 0, 0, 0.1);
	transform: translateY(-1px);
}

/* è¾“å…¥æ¡†æ ·å¼ */
:global(.wl-input) {
	border: 1px solid #e2e8f0;
	border-radius: 8px;
	padding: 0.75rem 1rem;
	font-size: 14px;
	transition: all 0.2s ease;
	background: #f8fafc;
	color: #334155;
}

:global(.wl-input:focus) {
	border-color: #3b82f6;
	box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.1);
	background: #ffffff;
	outline: none;
}

:global(.wl-input::placeholder) {
	color: #94a3b8;
}

/* æäº¤æŒ‰é’®æ ·å¼ */
:global(.wl-btn) {
	background: linear-gradient(135deg, #3b82f6 0%, #1d4ed8 100%);
	color: #ffffff;
	border: none;
	border-radius: 8px;
	padding: 0.75rem 1.5rem;
	font-weight: 500;
	font-size: 14px;
	cursor: pointer;
	transition: all 0.3s ease;
	box-shadow: 0 2px 4px rgba(59, 130, 246, 0.2);
}

:global(.wl-btn:hover) {
	background: linear-gradient(135deg, #2563eb 0%, #1e40af 100%);
	transform: translateY(-1px);
	box-shadow: 0 4px 8px rgba(59, 130, 246, 0.3);
}

:global(.wl-btn:active) {
	transform: translateY(0);
	box-shadow: 0 2px 4px rgba(59, 130, 246, 0.2);
}

/* è¯„è®ºå¡ç‰‡æ ·å¼ */
:global(.wl-card) {
	background: #ffffff;
	border: 1px solid #e2e8f0;
	border-radius: 12px;
	margin: 1.5rem 0;
	overflow: hidden;
	box-shadow: 0 1px 3px 0 rgba(0, 0, 0, 0.1);
	transition: all 0.3s ease;
}

:global(.wl-card:hover) {
	box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
	transform: translateY(-2px);
	border-color: #cbd5e1;
}

/* è¯„è®ºå¤´éƒ¨ */
:global(.wl-head) {
	background: linear-gradient(135deg, #f8fafc 0%, #f1f5f9 100%);
	border-bottom: 1px solid #e2e8f0;
	padding: 1rem 1.25rem;
	display: flex;
	align-items: center;
	gap: 0.75rem;
}

/* ç”¨æˆ·å¤´åƒ */
:global(.wl-avatar) {
	border-radius: 50%;
	border: 2px solid #e2e8f0;
	transition: all 0.2s ease;
	width: 40px;
	height: 40px;
}

:global(.wl-avatar:hover) {
	border-color: #3b82f6;
	transform: scale(1.05);
}

/* ç”¨æˆ·ä¿¡æ¯ */
:global(.wl-nick) {
	font-weight: 600;
	color: #1e293b;
	font-size: 15px;
	margin: 0;
}

/* ç®¡ç†å‘˜æ ‡è¯†ç¾åŒ– */
:global(.wl-tag) {
	background: linear-gradient(135deg, #f59e0b, #d97706);
	color: white;
	padding: 0.25rem 0.5rem;
	border-radius: 6px;
	font-size: 11px;
	font-weight: 500;
	margin-left: 0.5rem;
	text-transform: uppercase;
	letter-spacing: 0.05em;
}

/* æ—¶é—´æˆ³ */
:global(.wl-time) {
	color: #64748b;
	font-size: 13px;
	opacity: 0.8;
	margin-left: auto;
}

/* è¯„è®ºå†…å®¹ */
:global(.wl-content) {
	padding: 1.25rem;
	font-size: 15px;
	line-height: 1.7;
	color: #334155;
}

:global(.wl-content p) {
	margin: 0.75rem 0;
}

:global(.wl-content p:first-child) {
	margin-top: 0;
}

:global(.wl-content p:last-child) {
	margin-bottom: 0;
}

:global(.wl-content a) {
	color: #3b82f6;
	text-decoration: none;
	border-bottom: 1px solid transparent;
	transition: all 0.2s ease;
}

:global(.wl-content a:hover) {
	border-bottom-color: #3b82f6;
	background-color: rgba(59, 130, 246, 0.05);
	padding: 0 2px;
	border-radius: 2px;
}

/* è¯„è®ºæ“ä½œæŒ‰é’® */
:global(.wl-action) {
	padding: 0.75rem 1.25rem;
	border-top: 1px solid #f1f5f9;
	background: #f8fafc;
	display: flex;
	gap: 0.5rem;
}

:global(.wl-action button) {
	color: #64748b;
	background: transparent;
	border: none;
	padding: 0.5rem 0.75rem;
	border-radius: 6px;
	font-size: 13px;
	cursor: pointer;
	transition: all 0.2s ease;
	display: flex;
	align-items: center;
	gap: 0.25rem;
}

:global(.wl-action button:hover) {
	background: #e2e8f0;
	color: #334155;
	transform: translateY(-1px);
}

/* å›å¤åŒºåŸŸç¾åŒ– */
:global(.wl-quote) {
	background: linear-gradient(135deg, #f8fafc 0%, #f1f5f9 100%);
	border-left: 4px solid #3b82f6;
	padding: 0.75rem 1rem;
	margin: 0.75rem 0;
	border-radius: 0 8px 8px 0;
	font-size: 14px;
	color: #475569;
}

/* è¡¨æƒ…é€‰æ‹©å™¨ */
:global(.wl-emoji) {
	background: #ffffff;
	border: 1px solid #e2e8f0;
	border-radius: 12px;
	box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1);
	padding: 0.5rem;
}

/* åˆ†é¡µå™¨ç¾åŒ– */
:global(.wl-page) {
	margin-top: 2rem;
	text-align: center;
	display: flex;
	justify-content: center;
	gap: 0.5rem;
}

:global(.wl-page button) {
	background: #f1f5f9;
	color: #64748b;
	border: 1px solid #e2e8f0;
	padding: 0.5rem 1rem;
	border-radius: 8px;
	transition: all 0.2s ease;
	font-weight: 500;
}

:global(.wl-page button:hover) {
	background: #3b82f6;
	color: #ffffff;
	border-color: #3b82f6;
	transform: translateY(-1px);
}

:global(.wl-page .current) {
	background: #3b82f6;
	color: #ffffff;
	border-color: #3b82f6;
}

/* ç©ºçŠ¶æ€ç¾åŒ– */
:global(.wl-empty) {
	text-align: center;
	padding: 3rem 1rem;
	color: #64748b;
}

:global(.wl-empty::before) {
	content: "ğŸ’­";
	display: block;
	font-size: 2.5rem;
	margin-bottom: 1rem;
	opacity: 0.6;
}

/* åŠ è½½çŠ¶æ€ */
:global(.wl-loading) {
	text-align: center;
	padding: 2rem;
	color: #64748b;
}

/* éšè—ç”¨æˆ·ä»£ç†ä¿¡æ¯ */
:global(.wl-meta) {
	display: none !important;
}

/* å“åº”å¼è®¾è®¡ */
@media (max-width: 768px) {
	.waline-container {
		margin: 2rem -1rem 0;
	}
	
	.waline-container::before {
		margin: 0 1rem 1.5rem;
		font-size: 1.125rem;
	}
	
	:global(.wl-card) {
		border-radius: 0;
		border-left: none;
		border-right: none;
		margin: 0.75rem 0;
	}
	
	:global(.wl-editor) {
		border-radius: 0;
		border-left: none;
		border-right: none;
		margin: 0;
	}
	
	:global(.wl-head),
	:global(.wl-content),
	:global(.wl-action) {
		padding-left: 1rem;
		padding-right: 1rem;
	}
	
	:global(.wl-page) {
		padding: 0 1rem;
		flex-wrap: wrap;
	}
}

/* æš—è‰²æ¨¡å¼é€‚é…ï¼ˆå¯é€‰ï¼‰ */
@media (prefers-color-scheme: dark) {
	.waline-container::before {
		color: #e2e8f0;
		border-bottom-color: #374151;
	}
	
	:global(.wl-editor) {
		background: #1f2937;
		border-color: #374151;
	}
	
	:global(.wl-card) {
		background: #1f2937;
		border-color: #374151;
	}
}
</style>
